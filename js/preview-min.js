const candidateSelectors=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'];function isHidden(e){return null===e.offsetParent||"hidden"===getComputedStyle(e).visibility}function getAllTabbingElements(e){let t=e.querySelectorAll(candidateSelectors.join(",")),o=[];for(let e=0;e<t.length;e++){let n=t[e];!n.disabled&&getTabindex(n)>-1&&!isHidden(n)&&o.push(n)}return o}function focusTrap(e,t){if(!e||"Tab"!==e.key)return;if(!t||!t.contains)return process&&"development"===process.env.NODE_ENV&&console.warn("focus-trap-js: parent element is not defined"),!1;if(!t.contains(e.target))return!1;let o=getAllTabbingElements(t),n=o[0],i=o[o.length-1];return e.shiftKey&&e.target===n?(i.focus(),e.preventDefault(),!0):!e.shiftKey&&e.target===i&&(n.focus(),e.preventDefault(),!0)}function getTabindex(e){let t=parseInt(e.getAttribute("tabindex"),10);return isNaN(t)?isContentEditable(e)?0:e.tabIndex:t}function isContentEditable(e){return e.getAttribute("contentEditable")}function Overlay(){return this.el=this.create(),this}Overlay.prototype.ovelayElement=function(){return this.el},Overlay.prototype.create=function(){return this.el=document.createElement("div"),this.el.classList.add("modal-overlay","clearfix","hide"),document.body.append(this.el),this.el},Overlay.prototype.open=function(){this.removeFromClasslist("hide"),this.addToClasslist("opening"),this.addToClasslist("overflow-y-scroll")},Overlay.prototype.close=function(){this.addToClasslist("closing"),this.removeFromClasslist("active")},Overlay.prototype.openEvent=function(){this.removeFromClasslist("opening"),this.addToClasslist("active")},Overlay.prototype.closeEvent=function(){this.removeFromClasslist("closing"),this.addToClasslist("hide")},Overlay.prototype.addEvent=function(e,t,o){this.el.addEventListener(e,t,o)},Overlay.prototype.addToClasslist=function(e){return this.el.classList.add(e),this.el.classList.value},Overlay.prototype.removeFromClasslist=function(e){return this.el.classList.remove(e),this.el.classList.value},Overlay.prototype.append=function(e){this.el.append(e)};const openedEvent=new CustomEvent("opened"),closedEvent=new CustomEvent("closed"),overlay=new Overlay;function Preview(e,t){let o=this;this.callback=e||function(){},this.options={heading:"",subheading:"",headingLevel:"h2",id:"preview",placement:"left",image:"https://placehold.co/1920x490",innerHtml:""},void 0!==t&&this.updateOptions(t);let n=new URL(window.location.toString());this.urlParams=new URLSearchParams(n.search),this.urlHash=location.hash.length>=1?location.hash:"",this.overlay=overlay,this.modal=this.createElements(),this.setPlacement(),this.makeModal(),overlay.addEvent("click",o.close.bind(this),!1),document.querySelectorAll(".modal-close").forEach(function(e,t,n){o=o,e.addEventListener("click",o.close.bind(o),!1)}),document.addEventListener("keydown",function(e){focusTrap(e,o.modal.element)}),this.modal.element.addEventListener("click",function(e){e.stopPropagation()}),this.firstFocusEl=this.options.focusOnOpenElement||this.modal.element}Preview.prototype.updateOptions=function(e){let t=this,o=Object.getOwnPropertyNames(e);for(let n=0;n<o.length;n++){let i=o[n];t.options[i]=e[i]}},Preview.prototype.updateContent=function(e){this.updateOptions(e),this.setContent()},Preview.prototype.setContent=function(){let e=this.modal.header,t=this.modal.image;if(e.heading.textContent=this.options.heading,void 0!==this.options.subheading)void 0===e.subheading&&(e.subheading=document.createElement("span"),e.heading.className="modal-heading",e.container.append(e.heading)),e.subheading.textContent=" "+this.options.subheading;else{let t=e.container.querySelector(".modal-subheading");null!==t&&t.remove(),e.subheading=void 0}if(void 0!==this.options.sourceElement)this.modal.body.append(this.options.sourceElement);else{let e=document.createRange().createContextualFragment(this.options.innerHtml);this.modal.body.append(e)}this.options.hasOwnProperty("image")&&(t.src=this.options.image),this.modal.footer.action.href=this.options.url,this.modal.footer.action.textContent="View "+this.options.heading+" >"},Preview.prototype.changePlacement=function(e){this.options.placement=e,this.setPlacement()},Preview.prototype.setPlacement=function(){this.modal.element.setAttribute("data-placement",this.options.placement)},Preview.prototype.makeModal=function(){this.setContent(),overlay.append(this.modal.element),this.modal.element.classList.add("ready"),this.callback(this.modal.element)},Preview.prototype.createElements=function(){let e=document.createElement("div");e.id=this.options.id,e.className="modal",e.setAttribute("role","dialog"),e.setAttribute("aria-modal","true"),e.setAttribute("aria-labelledby",this.options.id+"-header"),e.setAttribute("tabindex","0");let t=document.createElement("div");t.className="modal-header",t.id=this.options.id+"-header";let o=document.createElement(this.options.headingLevel);o.className="modal-heading";let n=document.createElement("span");n.className="modal-title";let i=document.createElement("small");null!==this.options.subheading&&(i.className="modal-subtitle",o.append(i)),o.prepend(n),t.prepend(o);let s=document.createElement("div");s.className="modal-footer";let a=document.createElement("button");a.setAttribute("type","buton"),a.setAttribute("aria-label","Close preview"),a.classList.add("btn","btn-secondary","modal-close"),a.textContent="Close";let l=document.createElement("a");l.classList.add("btn","btn-primary");let d=document.createTextNode(" ");s.append(l),s.append(d),s.append(a);let r=document.createElement("img");r.className="modal-img invisible";let c=document.createElement("div");c.className="modal-body";let p=document.createElement("button");p.setAttribute("type","buton"),p.setAttribute("aria-label","Close preview"),p.classList.add("close-button","modal-close"),p.innerHTML="&times;";let m=p.appendChild(document.createElement("span"));return m.className="visually-hidden",m.textContent="Close preview",e.append(t),e.append(r),e.append(c),e.append(s),e.append(p),{element:e,header:{element:o,container:t,heading:n,subheading:i},footer:{container:s,cancel:a,action:l},image:r,body:c,closeBtn:p}},Preview.prototype.getInstance=function(){return this},Preview.prototype.modalElement=function(){return this.modal.element},Preview.prototype.open=function(e){this.originEl=e;let t=this;overlay.open(),t.modal.image.onload=function(){t.modal.image.classList.remove("invisible")},document.body.classList.add("overflow-y-hidden"),document.body.classList.remove("overflow-y-scroll"),t.urlParams.set("preview","open"),t.stateObj={modal:"open"},t.timeoutID=window.setTimeout(t.openEvents.bind(this),20),document.addEventListener("keyup",t.handleKeyup.bind(this),!1)},Preview.prototype.close=function(e){void 0!==e&&e.stopPropagation();let t=this,o=t.handlePopstate;window.removeEventListener("popstate",o),overlay.close(),document.body.classList.add("overflow-y-scroll"),document.body.classList.remove("overflow-y-hidden"),t.timeoutID=window.setTimeout(t.closeEvents.bind(this),600),t.urlParams.delete("preview"),t.urlParams.toString().length>0?window.history.replaceState(t.stateObj,"",`${location.pathname}?${t.urlParams}${t.urlHash}`):window.history.replaceState(t.stateObj,"",`${location.pathname}${t.urlHash}`)},Preview.prototype.openEvents=function(){let e=this;overlay.openEvent(),window.clearTimeout(e.timeoutID),window.setTimeout(function(){e.firstFocusEl.focus(),e.modal.element.dispatchEvent(openedEvent)},500),window.history.pushState(e.stateObj,"",`${location.pathname}?${e.urlParams}${e.urlHash}`),window.addEventListener("popstate",e.handlePopstate.bind(this),!1)},Preview.prototype.closeEvents=function(){for(overlay.closeEvent(),window.clearTimeout(this.timeoutID),this.modal.element.dispatchEvent(closedEvent),document.removeEventListener("keyup",this.handleKeyup),this.modal.image.classList.add("invisible");this.modal.body.firstChild;)this.modal.body.removeChild(this.modal.body.firstChild);this.originEl.focus()},Preview.prototype.handlePopstate=function(){this.close()},Preview.prototype.handleKeyup=function(e){"Esc"!==e.key&&"Escape"!==e.key||this.close()};